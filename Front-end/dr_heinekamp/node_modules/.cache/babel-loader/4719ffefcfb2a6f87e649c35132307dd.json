{"ast":null,"code":"import _regeneratorRuntime from\"H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Fragment,useCallback,useContext,useEffect,useState}from\"react\";import Moment from'moment';import FileIcon from\"./FileIcon\";import{Download,ThreeDots,XLg}from\"react-bootstrap-icons\";import AuthContext from\"../../../store/auth-context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FileItem=function FileItem(props){var context=useContext(AuthContext);var _useState=useState(0),_useState2=_slicedToArray(_useState,2),downloadCount=_useState2[0],setDownloadCount=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var Details=function Details(event){event.preventDefault();props.FileDetails(props);};var count=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('https://sharingfileapp2022.azurewebsites.net/api/inbox/count?fileId='+props.id);case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;setDownloadCount(data);case 7:case\"end\":return _context.stop();}}},_callee);})),[props.id]);useEffect(function(){count();},[count]);var Delete=function Delete(){setIsLoading(true);fetch(\"https://sharingfileapp2022.azurewebsites.net/api/userFiles/delete?id=\"+props.id+\"&userId=\"+context.userId,{method:'Delete'}).then(function(res){if(res.ok){setIsLoading(false);props.Remove(props.id);return res.json();}else{return res.json().then(function(data){var errorMessage='Delete failed';if(data&&data.error&&data.error.message){errorMessage=data.error.message;}throw new Error(errorMessage);});}}).catch(function(error){setIsLoading(false);});};return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-6 pb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card rounded-3 h-100\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",children:props.title}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:Moment(props.uploadDate).format('dddd - DD MMMM yyyy')}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(FileIcon,{format:props.file})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:Details,className:\"border border-1 btn btn-sm rounded-circle\",children:/*#__PURE__*/_jsx(ThreeDots,{className:\"text-primary mb-1\",size:15})}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:Delete,className:\"border border-1 btn btn-sm rounded-circle mx-1\",children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})})}),!isLoading&&/*#__PURE__*/_jsx(XLg,{className:\"text-danger mb-1\",size:15})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"float-end text-info p-1 text-center\",children:[/*#__PURE__*/_jsx(Download,{className:\"mb-1\"}),\" \",downloadCount,\" times\"]})]})})})});};export default FileItem;","map":{"version":3,"names":["React","Fragment","useCallback","useContext","useEffect","useState","Moment","FileIcon","Download","ThreeDots","XLg","AuthContext","FileItem","props","context","downloadCount","setDownloadCount","isLoading","setIsLoading","Details","event","preventDefault","FileDetails","count","fetch","id","response","json","data","Delete","userId","method","then","res","ok","Remove","errorMessage","error","message","Error","catch","title","uploadDate","format","file"],"sources":["H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/src/Components/Dashboard/Files/FileItem.js"],"sourcesContent":["import React, { Fragment, useCallback, useContext, useEffect, useState } from \"react\"\r\nimport Moment from 'moment';\r\nimport FileIcon from \"./FileIcon\";\r\nimport { Download, ThreeDots, XLg } from \"react-bootstrap-icons\";\r\nimport AuthContext from \"../../../store/auth-context\";\r\n\r\nconst FileItem = (props) => {\r\n    const context = useContext(AuthContext);\r\n    const [downloadCount,setDownloadCount] = useState(0);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const Details = (event) => {\r\n        event.preventDefault();\r\n        props.FileDetails(props);\r\n    }\r\n\r\n    const count =useCallback(async () => {\r\n        const response = await fetch('https://sharingfileapp2022.azurewebsites.net/api/inbox/count?fileId=' + props.id);\r\n\r\n        const data = await response.json();\r\n        setDownloadCount(data);\r\n\r\n    },[props.id])\r\n\r\n    useEffect(()=>{\r\n        count();\r\n    },[count])\r\n    \r\n    const Delete = () => {\r\n        setIsLoading(true);\r\n        fetch(\"https://sharingfileapp2022.azurewebsites.net/api/userFiles/delete?id=\" + props.id + \"&userId=\" + context.userId,\r\n            {\r\n                method: 'Delete'\r\n            }\r\n        ).then(res => {\r\n            if (res.ok) {\r\n                setIsLoading(false);\r\n                props.Remove(props.id);\r\n                return res.json();\r\n            }\r\n            else {\r\n                return res.json().then((data) => {\r\n                    let errorMessage = 'Delete failed';\r\n                    if (data && data.error && data.error.message) {\r\n                        errorMessage = data.error.message;\r\n                    }\r\n                    throw new Error(errorMessage);\r\n                });\r\n            }\r\n        }).catch((error) => {\r\n            setIsLoading(false);\r\n        });\r\n    }\r\n\r\n    return (\r\n        <Fragment>\r\n            <div className=\"col-lg-6 pb-3\">\r\n                <div className=\"card rounded-3 h-100\">\r\n                    <div className=\"card-body\">\r\n                        <h5 className=\"card-title\">{props.title}</h5>\r\n                        <p className=\"card-text\">{Moment(props.uploadDate).format('dddd - DD MMMM yyyy')}</p>\r\n                        <p>\r\n                            <FileIcon format={props.file} />\r\n                        </p>\r\n                        <button type=\"button\" onClick={Details} className=\"border border-1 btn btn-sm rounded-circle\">\r\n                            <ThreeDots className=\"text-primary mb-1\" size={15} />\r\n                        </button>\r\n                        <button type=\"button\" onClick={Delete} className=\"border border-1 btn btn-sm rounded-circle mx-1\">\r\n                        {isLoading && <div className=\"d-flex justify-content-center\">\r\n                                <div className=\"spinner-border\" role=\"status\">\r\n                                    <span className=\"visually-hidden\">Loading...</span>\r\n                                </div>\r\n                            </div>}\r\n                            {!isLoading && <XLg className=\"text-danger mb-1\" size={15} />}\r\n                        </button>\r\n                        <label className=\"float-end text-info p-1 text-center\"><Download className=\"mb-1\"/> {downloadCount} times</label>\r\n                    </div> \r\n                </div>\r\n            </div>\r\n        </Fragment>\r\n    )\r\n}\r\nexport default FileItem;"],"mappings":"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"},"metadata":{},"sourceType":"module"}