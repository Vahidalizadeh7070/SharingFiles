{"ast":null,"code":"import _regeneratorRuntime from\"H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{Fragment,useCallback,useContext,useEffect,useState}from\"react\";import Moment from'moment';import FileIcon from\"../Dashboard/Files/FileIcon\";import'../Inbox/inbox.css';import AuthContext from\"../../store/auth-context\";import ListOfSubFiles from\"../Dashboard/Files/ListOfSubFiles\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var InboxItem=function InboxItem(props){var context=useContext(AuthContext);var _useState=useState(),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),expire=_useState4[0],setExpire=_useState4[1];var checkExpiration=useCallback(function(){var current=new Date();if(Moment(props.expirationDate).format('DD')>=current.getDate()){setExpire(false);}},[props.expirationDate]);useEffect(function(){checkExpiration();},[checkExpiration]);var Download=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch('https://sharingfileapp2022.azurewebsites.net/api/download/download?userId='+context.userId+'&fileId='+props.userFilesId);case 3:response=_context.sent;if(!(response.status===400)){_context.next=8;break;}throw new Error('There is no file');case 8:if(response.ok){_context.next=10;break;}throw new Error('Something went wrong!!!');case 10:_context.next=12;return response.json();case 12:data=_context.sent;console.log(data);_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);setError(_context.t0.message);case 19:case\"end\":return _context.stop();}}},_callee,null,[[0,16]]);})),[context.userId,props.userFilesId]);return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-6 pb-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card rounded-3 h-100  bg-inbox\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",children:props.senderUserName}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:Moment(props.expirationDate).format('dddd - DD MMMM yyyy')}),/*#__PURE__*/_jsx(FileIcon,{format:props.fileName}),/*#__PURE__*/_jsx(\"hr\",{}),expire&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-center text-danger\",children:[\"It expired. You can ask from \",props.senderUserName,\" to send it again.\"]}),!expire&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Main file: \",props.title]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-success rounded-3 shadow\",onClick:Download,children:\"Download\"}),/*#__PURE__*/_jsx(\"div\",{className:\"row pt-5\",children:/*#__PURE__*/_jsx(ListOfSubFiles,{showDeleteButton:false,fileId:props.userFilesId})})]})]})})})});};export default InboxItem;","map":{"version":3,"names":["React","Fragment","useCallback","useContext","useEffect","useState","Moment","FileIcon","AuthContext","ListOfSubFiles","InboxItem","props","context","error","setError","expire","setExpire","checkExpiration","current","Date","expirationDate","format","getDate","Download","fetch","userId","userFilesId","response","status","Error","ok","json","data","console","log","message","senderUserName","fileName","title"],"sources":["H:/WebSite Project/dr_heinekamp/Front-end/dr_heinekamp/src/Components/Inbox/InboxItem.js"],"sourcesContent":["import React, { Fragment, useCallback, useContext, useEffect, useState } from \"react\"\r\nimport Moment from 'moment';\r\nimport FileIcon from \"../Dashboard/Files/FileIcon\";\r\nimport '../Inbox/inbox.css'\r\nimport AuthContext from \"../../store/auth-context\";\r\nimport ListOfSubFiles from \"../Dashboard/Files/ListOfSubFiles\";\r\n\r\nconst InboxItem = (props) => {\r\n    const context = useContext(AuthContext);\r\n    const [error, setError] = useState();\r\n    const [expire, setExpire] = useState(true);\r\n    const checkExpiration = useCallback(() => {\r\n        const current = new Date();\r\n        if (Moment(props.expirationDate).format('DD') >= current.getDate()) {\r\n            setExpire(false);\r\n        }\r\n    }, [props.expirationDate])\r\n    useEffect(() => {\r\n        checkExpiration();\r\n    }, [checkExpiration])\r\n\r\n    const Download = useCallback(async () => {\r\n        try {\r\n            const response = await fetch(\r\n                'https://sharingfileapp2022.azurewebsites.net/api/download/download?userId=' + context.userId + '&fileId=' + props.userFilesId);\r\n\r\n            if (response.status === 400) {\r\n                throw new Error('There is no file');\r\n            }\r\n            else if (!response.ok) {\r\n                throw new Error('Something went wrong!!!');\r\n            }\r\n            const data = await response.json();\r\n\r\n            console.log(data);\r\n        }\r\n        catch (error) {\r\n            setError(error.message);\r\n        }\r\n    }, [context.userId, props.userFilesId]);\r\n\r\n    return (\r\n        <Fragment>\r\n            <div className=\"col-lg-6 pb-3\">\r\n                <div className=\"card rounded-3 h-100  bg-inbox\">\r\n                    <div className=\"card-body\">\r\n                        <h5 className=\"card-title\">{props.senderUserName}</h5>\r\n                        <p className=\"card-text\">{Moment(props.expirationDate).format('dddd - DD MMMM yyyy')}</p>\r\n                        <FileIcon format={props.fileName} />\r\n                        <hr />\r\n\r\n                        {expire && <p className=\"text-center text-danger\">It expired. You can ask from {props.senderUserName} to send it again.</p>}\r\n                        {!expire && <div>\r\n                            <p>Main file: {props.title}</p>\r\n                            <button className=\"btn btn-sm btn-success rounded-3 shadow\" onClick={Download}>Download</button>\r\n                            <div className=\"row pt-5\">\r\n                                <ListOfSubFiles showDeleteButton={false} fileId={props.userFilesId} />\r\n                            </div>\r\n                        </div>\r\n                        }\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Fragment>\r\n    )\r\n}\r\nexport default InboxItem;"],"mappings":"obAAA,MAAOA,MAAP,EAAgBC,QAAhB,CAA0BC,WAA1B,CAAuCC,UAAvC,CAAmDC,SAAnD,CAA8DC,QAA9D,KAA8E,OAA9E,CACA,MAAOC,OAAP,KAAmB,QAAnB,CACA,MAAOC,SAAP,KAAqB,6BAArB,CACA,MAAO,oBAAP,CACA,MAAOC,YAAP,KAAwB,0BAAxB,CACA,MAAOC,eAAP,KAA2B,mCAA3B,C,wFAEA,GAAMC,UAAS,CAAG,QAAZA,UAAY,CAACC,KAAD,CAAW,CACzB,GAAMC,QAAO,CAAGT,UAAU,CAACK,WAAD,CAA1B,CACA,cAA0BH,QAAQ,EAAlC,wCAAOQ,KAAP,eAAcC,QAAd,eACA,eAA4BT,QAAQ,CAAC,IAAD,CAApC,yCAAOU,MAAP,eAAeC,SAAf,eACA,GAAMC,gBAAe,CAAGf,WAAW,CAAC,UAAM,CACtC,GAAMgB,QAAO,CAAG,GAAIC,KAAJ,EAAhB,CACA,GAAIb,MAAM,CAACK,KAAK,CAACS,cAAP,CAAN,CAA6BC,MAA7B,CAAoC,IAApC,GAA6CH,OAAO,CAACI,OAAR,EAAjD,CAAoE,CAChEN,SAAS,CAAC,KAAD,CAAT,CACH,CACJ,CALkC,CAKhC,CAACL,KAAK,CAACS,cAAP,CALgC,CAAnC,CAMAhB,SAAS,CAAC,UAAM,CACZa,eAAe,GAClB,CAFQ,CAEN,CAACA,eAAD,CAFM,CAAT,CAIA,GAAMM,SAAQ,CAAGrB,WAAW,wEAAC,6LAEEsB,MAAK,CACxB,6EAA+EZ,OAAO,CAACa,MAAvF,CAAgG,UAAhG,CAA6Gd,KAAK,CAACe,WAD3F,CAFP,QAEfC,QAFe,oBAKjBA,QAAQ,CAACC,MAAT,GAAoB,GALH,+BAMX,IAAIC,MAAJ,CAAU,kBAAV,CANW,WAQXF,QAAQ,CAACG,EARE,+BASX,IAAID,MAAJ,CAAU,yBAAV,CATW,gCAWFF,SAAQ,CAACI,IAAT,EAXE,SAWfC,IAXe,eAarBC,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAbqB,iFAgBrBlB,QAAQ,CAAC,YAAMqB,OAAP,CAAR,CAhBqB,qEAAD,GAkBzB,CAACvB,OAAO,CAACa,MAAT,CAAiBd,KAAK,CAACe,WAAvB,CAlByB,CAA5B,CAoBA,mBACI,KAAC,QAAD,wBACI,YAAK,SAAS,CAAC,eAAf,uBACI,YAAK,SAAS,CAAC,gCAAf,uBACI,aAAK,SAAS,CAAC,WAAf,wBACI,WAAI,SAAS,CAAC,YAAd,UAA4Bf,KAAK,CAACyB,cAAlC,EADJ,cAEI,UAAG,SAAS,CAAC,WAAb,UAA0B9B,MAAM,CAACK,KAAK,CAACS,cAAP,CAAN,CAA6BC,MAA7B,CAAoC,qBAApC,CAA1B,EAFJ,cAGI,KAAC,QAAD,EAAU,MAAM,CAAEV,KAAK,CAAC0B,QAAxB,EAHJ,cAII,aAJJ,CAMKtB,MAAM,eAAI,WAAG,SAAS,CAAC,yBAAb,2CAAqEJ,KAAK,CAACyB,cAA3E,wBANf,CAOK,CAACrB,MAAD,eAAW,oCACR,mCAAeJ,KAAK,CAAC2B,KAArB,GADQ,cAER,eAAQ,SAAS,CAAC,yCAAlB,CAA4D,OAAO,CAAEf,QAArE,sBAFQ,cAGR,YAAK,SAAS,CAAC,UAAf,uBACI,KAAC,cAAD,EAAgB,gBAAgB,CAAE,KAAlC,CAAyC,MAAM,CAAEZ,KAAK,CAACe,WAAvD,EADJ,EAHQ,GAPhB,GADJ,EADJ,EADJ,EADJ,CAwBH,CA1DD,CA2DA,cAAehB,UAAf"},"metadata":{},"sourceType":"module"}